<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acceso al sistema - CUE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .navbar-cue {
            background-color: #00529c;
            height: 56px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 50;
        }
        .sidebar {
            width: 280px;
            background: #fff;
            position: fixed;
            top: 56px;
            left: 0;
            bottom: 0;
            border-right: 1px solid #e5e7eb;
            overflow-y: auto;
            z-index: 40;
        }
        .sidebar-user {
            padding: 1rem 1.25rem;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 600;
            color: #374151;
        }
        .sidebar-user i { color: #6b7280; }
        .sidebar-nav a {
            display: block;
            padding: 0.65rem 1.25rem;
            color: #b91c1c;
            text-decoration: none;
            font-size: 14px;
            border-left: 3px solid transparent;
            transition: background 0.15s, border-color 0.15s;
        }
        .sidebar-nav a:hover {
            background: #fef2f2;
        }
        .sidebar-nav a.movilidad:hover {
            background: #eff6ff;
            border-left-color: #00529c;
            color: #00529c;
        }
        .main-content {
            margin-left: 280px;
            margin-top: 56px;
            min-height: calc(100vh - 56px);
            background: #fff;
            position: relative;
        }
        .waves {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 260px;
            pointer-events: none;
        }
        .waves svg {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body class="min-h-screen bg-white">
    <nav class="navbar-cue">
        <div class="flex items-center gap-3">
            <img src="assets/img/logo_avh.png" alt="Alexander von Humboldt" class="h-8 bg-white p-1 rounded" onerror="this.style.display='none'">
            <img src="assets/img/logo_camara.png" alt="Cámara de Comercio" class="h-7 opacity-95" onerror="this.style.display='none'">
        </div>
        <div class="flex items-center gap-3 text-white">
            <i data-lucide="upload-cloud" class="w-5 h-5 opacity-90" title="Subir"></i>
            <i data-lucide="folder" class="w-5 h-5 opacity-90" title="Archivo"></i>
            <i data-lucide="play-circle" class="w-5 h-5 opacity-90" title="Ayuda"></i>
        </div>
    </nav>

    <aside class="sidebar">
        <div class="sidebar-user">
            <i data-lucide="user" class="w-5 h-5"></i>
            <span id="sidebarUserName">Usuario</span>
        </div>
        <nav class="sidebar-nav py-2">
            <a href="#">Gestión de usuarios</a>
            <a href="#">Administración ZonaPagos</a>
            <a href="#">Proyectos</a>
            <a href="#">Proyectos IST</a>
            <a href="#">Archivo</a>
            <a href="#">Control documental</a>
            <a href="#">Paz y Salvo</a>
            <a href="#">Miscelánea</a>
            <a href="modules/dashboard-estudiante.html" id="linkMovilidad" class="movilidad">Movilidad</a>
            <a href="#">Créditos</a>
            <a href="#">Digitalización de documentos para aprobación</a>
            <a href="#">Digitalización historia académica</a>
            <a href="#">Aprobación de compras y servicios</a>
            <a href="#">Gestión de equipos</a>
            <a href="#">Votación</a>
            <a href="#">Educación continua</a>
            <a href="#">Talento humano</a>
        </nav>
    </aside>

    <main class="main-content relative">
        <div class="absolute top-4 left-4">
            <span class="inline-block px-3 py-1.5 text-sm font-semibold border-2 border-amber-400 bg-amber-50 text-amber-800 rounded">Cerrar</span>
        </div>
        <div class="waves">
            <svg viewBox="0 0 1440 320" preserveAspectRatio="none" class="w-full h-full">
                <path fill="#87ceeb" fill-opacity="0.45" d="M0,160L48,176C96,192,192,224,288,213.3C384,203,480,149,576,138.7C672,128,768,160,864,165.3C960,171,1056,149,1152,138.7C1248,128,1344,128,1392,128L1440,128L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path>
                <path fill="#00529c" fill-opacity="0.3" d="M0,192L48,197.3C96,203,192,213,288,208C384,203,480,181,576,165.3C672,149,768,139,864,149.3C960,160,1056,192,1152,197.3C1248,203,1344,181,1392,170.7L1440,160L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path>
                <path fill="#003366" fill-opacity="0.4" d="M0,224L48,213.3C96,203,192,181,288,186.7C384,192,480,224,576,224C672,224,768,192,864,181.3C960,171,1056,181,1152,197.3C1248,213,1344,235,1392,245.3L1440,256L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path>
            </svg>
        </div>
    </main>

    <script src="assets/js/auth.js"></script>
    <script>
        (function() {
            const user = AuthService.checkAuth();
            const backofficeCodes = ['ANI_SECRETARIA', 'ANI_DIRECCION', 'COORD_ACAD', 'SST', 'REGISTRO'];
            const isBackoffice = user && user.role && backofficeCodes.includes(user.role.code);

            if (!user || !isBackoffice) {
                window.location.href = 'index-sistema.html';
                return;
            }

            const name = user.name || user.email || 'Usuario';
            document.getElementById('sidebarUserName').textContent = name;

            const dashboardPath = user.role.redirect || 'dashboard-ani.html';
            const movilidadLink = document.getElementById('linkMovilidad');
            movilidadLink.href = 'modules/' + dashboardPath;
            movilidadLink.addEventListener('click', function(e) {
                e.preventDefault();
                window.location.href = 'modules/' + dashboardPath;
            });

            if (typeof lucide !== 'undefined') lucide.createIcons();
        })();
    </script>
</body>
</html>
